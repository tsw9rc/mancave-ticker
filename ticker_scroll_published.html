    <!DOCTYPE html><html><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>ManCave Ticker — Scroll (published)</title>
    <style>
    :root{--bg:#000;--fg:#fff;--height:64px;--gap:28px;--speed:80s}
    *{box-sizing:border-box}body{margin:0;background:var(--bg);color:var(--fg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
    .bar{position:fixed;left:0;right:0;bottom:0;height:var(--height);background:#000;overflow:hidden;border-top:2px solid #333}
    .track{display:flex;align-items:center;gap:var(--gap);white-space:nowrap;will-change:transform}
    .item{display:flex;align-items:center;gap:10px;padding:8px 14px;border-radius:14px}
    .logo{width:40px;height:40px;object-fit:contain;background:rgba(255,255,255,.08);border-radius:8px}
    .meta{opacity:.9}
    @keyframes scroll{from{transform:translateX(0)}to{transform:translateX(-50%)}}
    .scrolling{animation:scroll var(--speed) linear infinite}
    .topbar{position:fixed;left:0;right:0;top:0;height:32px;background:#111;color:#bbb;font-size:12px;display:flex;align-items:center;justify-content:space-between;padding:0 10px;border-bottom:1px solid #222}
    </style></head><body>
    <div class="topbar"><span>ManCave Ticker — Scroll (published)</span><span id="status">Loading…</span></div>
    <div class="bar"><div id="lane" class="track"></div></div>
    <script>
    const CONFIG = {
      CSV_URL: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRH5rLrk8P5yASsNqow9o0qqgP8XQ09vB1UzarN8CJXZIDBKZ72zq-fqWUUowgj-Q_PAt3ujib-idmF/pub?gid=1511185785&single=true&output=csv',
      MODE: 'published',
      REFRESH_MS: 300000,
      LOOP_DURATION_SEC: 60,
    };
    const lane=document.getElementById('lane'); const statusEl=document.getElementById('status');
    async function loadCSV(){ statusEl.textContent="Loading…"; const res=await fetch(CONFIG.CSV_URL,{cache:"no-store"}); const text=await res.text(); return parseCSV(text); }
    function buildItems(rows){
      if (!rows.length) return []; const header=rows[0], idx=idxMap(header), items=[];
      for (let r=1;r<rows.length;r++){ const row=rows[r]; if (!row || !row[idx.Team]) continue;
        const team=row[idx.Team]; const primary=(row[idx.PrimaryHex]||"#222").trim(); const secondary=(row[idx.SecondaryHex]||"#333").trim(); const logo=row[idx.Logo]||""; const fg=contrastColor(primary);
        if (CONFIG.MODE==="published"){ const wl=row[idx.Overall_WL]||""; const pct=row[idx.Overall_PCT]||""; const rank=row[idx.Rank]||""; const arrow=row[idx.Arrow]||""; const pf=row[idx.PF]||""; const pa=row[idx.PA]||""; const ticker=row[idx.Ticker]||"";
          items.push({team,primary,secondary,logo,fg,line1:`${team}`,line2:`${ticker}${rank?` • Rank ${rank} ${arrow}`:''} • ${wl}${pct?` (${pct})`:''} • PF ${pf} / PA ${pa}`}); }
        else { const gd=fmtDate(row[idx.GameDate]||""); const ha=row[idx.HomeAway]||""; const opp=row[idx.Opponent]||""; const res=row[idx.Result]||"";
          items.push({team,primary,secondary,logo,fg,line1:`${team} ${ha?`(${ha})`:''}`,line2:`${gd} vs ${opp}${res?` • ${res}`:''}`}); }
      } return items;
    }
    function render(items){
      lane.innerHTML=""; const wrap=document.createElement('div'); wrap.style.display="flex"; wrap.style.alignItems="center"; wrap.style.gap="var(--gap)";
      const all=items.concat(items); for (const it of all){ const el=document.createElement('div'); el.className="item"; el.style.background=it.primary; el.style.color=it.fg;
        el.innerHTML=`${it.logo?`<img class="logo" src="${it.logo}" alt="">`:''}<div><div style="font-weight:800;font-size:16px;line-height:1.15">${it.line1}</div><div class="meta" style="font-size:13px;line-height:1.15">${it.line2}</div></div>`;
        wrap.appendChild(el); } lane.appendChild(wrap);
      const totalWidth=wrap.scrollWidth/2; const pxPerSec=Math.max(80,totalWidth/CONFIG.LOOP_DURATION_SEC); const duration=totalWidth/pxPerSec;
      document.documentElement.style.setProperty('--speed',`${duration*2}s`); lane.classList.remove('scrolling'); void lane.offsetWidth; lane.classList.add('scrolling');
    }
    async function refresh(){ try{ const rows=await loadCSV(); const items=buildItems(rows); render(items); statusEl.textContent=`Updated • ${new Date().toLocaleTimeString()}`; } catch(e){ console.error(e); statusEl.textContent="Load error"; } }
    setInterval(refresh, CONFIG.REFRESH_MS); refresh();
    </script>
    <script>
function parseCSV(text) {
  const rows = []; let i = 0, field = '', row = [], inQuotes = false;
  while (i < text.length) { const c = text[i];
    if (inQuotes) { if (c === '"') { if (text[i+1] === '"') { field += '"'; i++; } else { inQuotes = false; } } else { field += c; } }
    else { if (c === '"') inQuotes = true; else if (c === ',') { row.push(field); field=''; }
           else if (c === '\n' || c === '\r') { if (c === '\r' && text[i+1] === '\n') i++; row.push(field); field=''; if (row.length) rows.push(row); row = []; }
           else { field += c; } }
    i++; }
  if (field.length || row.length) { row.push(field); rows.push(row); }
  return rows;
}
function contrastColor(hex) {
  const h = (hex||'').replace('#',''); if (h.length !== 6) return '#FFFFFF';
  const r = parseInt(h.slice(0,2),16), g = parseInt(h.slice(2,4),16), b = parseInt(h.slice(4,6),16);
  const yiq = ((r*299)+(g*587)+(b*114))/1000; return yiq >= 128 ? '#000000' : '#FFFFFF';
}
function fmtDate(iso) {
  if (!iso) return ''; if (/^\d{4}-\d{2}-\d{2}$/.test(iso)) return iso;
  const d = new Date(iso); if (isNaN(d)) return iso;
  const y = d.getFullYear(), m = String(d.getMonth()+1).padStart(2,'0'), da = String(d.getDate()).padStart(2,'0');
  return `${y}-${m}-${da}`;
}
function idxMap(header) { const m = {}; header.forEach((h,i)=> m[h.trim()] = i); return m; }
</script>

    </body></html>
